# {{- if .Values.notebooks.remoteClusters }}
# {{- $renkuFullname := include "renku.fullname" . -}}
# {{- $secretName := cat $renkuFullname "-notebooks-remote-clusters" | nospace }}
# {{- $existingSecret := (lookup "v1" "Secret" .Release.Namespace $secretName) }}
# apiVersion: v1
# kind: Secret
# metadata:
#   name: {{ $secretName }}
#   labels:
#     app: {{ template "renku.name" . }}
#     chart: {{ template "renku.chart" . }}
#     release: {{ .Release.Name }}
#     heritage: {{ .Release.Service }}
#   annotations:
#     # If "keep" resource policy is removed the secret is deleted post upgrade see https://github.com/helm/helm/issues/8420
#     "helm.sh/resource-policy": keep
#     "helm.sh/hook": "pre-install,pre-upgrade,pre-rollback"
# type: Opaque
# data:
# {{- range $name, $value := .Values.notebooks.remoteClusters }}
# {{- $kubecfg := $value.kubeConfig | b64enc | quote }}
# {{- if and $existingSecret (get $existingSecret $name ) }}
# {{- $kubecfg = (get $existingSecret $name ) }}
# {{- end}}
#     {{ $name }}: {{ $kubecfg }}
# {{- end -}}
# {{- end -}}
